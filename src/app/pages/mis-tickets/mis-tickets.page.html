<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button
        [defaultHref]="backHref"
        routerDirection="back"
        (click)="onBackClick()">
      </ion-back-button>
    </ion-buttons>
    <ion-title>Mis Tickets de Soporte</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Mis Tickets</ion-title>
    </ion-toolbar>
  </ion-header>

  <div class="ion-padding">
    <p>Aqu√≠ puedes ver el status de todas tus consultas enviadas.</p>
  </div>
  
  <div *ngIf="loading" class="ion-text-center ion-padding-vertical">
    <ion-spinner name="crescent"></ion-spinner>
    <p class="ion-margin-top">Cargando tickets...</p>
  </div>

  <ion-alert
    [isOpen]="!!error"
    [header]="'Error'"
    [message]="error || ''"
    [buttons]="['OK']"
  ></ion-alert>

  <ion-list *ngIf="!loading && !error">
    <!-- Lista de Tickets -->
    <ion-item 
      *ngFor="let ticket of tickets" 
      [routerLink]="['/detalle-ticket', ticket.id]" 
      button 
      detail="false">
      <ion-icon 
        slot="start" 
        [name]="getStatusIcon(ticket.status)" 
        [color]="getStatusColor(ticket.status)"
      ></ion-icon>
      
      <ion-label>
        <h2>Ticket #{{ ticket.id }}</h2>
        <p>{{ getSummary(ticket.message) }}</p>
      </ion-label>
      
      <ion-note 
        slot="end" 
        [color]="getStatusColor(ticket.status)">
      </ion-note>

      <ion-icon slot="end" name="arrow-forward-outline"></ion-icon>
    </ion-item>
    
    <!-- Mensaje si no hay tickets -->
    <ion-item *ngIf="tickets.length === 0 && !loading">
      <ion-label class="ion-text-center ion-padding-vertical">
        No tienes tickets de soporte registrados.
      </ion-label>
    </ion-item>
  </ion-list>
</ion-content>
